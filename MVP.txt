# **MudMind MVP: План разработки**

## **Концепция продукта**
**MudMind** — кооперативный клиент для текстовых MUD-игр, где человек играет вместе с ИИ-помощником. Не автономный бот, а "первый офицер", который помогает капитану (игроку) принимать решения.

## **Цель MVP**
Создать минимально рабочую версию, которая доказывает концепцию "человек+ИИ играют вместе" за минимальное время.

### **Критерии успеха MVP:**
1. Установка ≤ 5 минут (программа + микро-модель)
2. Работа из коробки (без скачивания дополнительных моделей)
3. Пользователь видит, что ИИ понимает мир MUD и дает полезные советы
4. Можно отправить команду в MUD через интерфейс ИИ

---

## **Архитектура MVP**

### **1. Физическая структура дистрибутива**
```
MudMind_Alpha_v0.1/          (≈550 MB распакованный)
├── MudMind.exe              (30 MB, скомпилированный Python)
├── brain/
│   └── mudreflex-core.gguf  (500 MB, встроенная микро-модель)
├── config/
│   └── settings.json        (настройки подключений)
└── README.txt              (3 шага: подключить → играть → получать советы)
```

### **2. Технический стек**
- **Язык:** Python 3.10
- **GUI:** Dear PyGui (легковесный, GPU-ускоренный)
- **ML:** llama-cpp-python (для GGUF моделей)
- **База данных:** SQLite (текущая сессия)
- **Сеть:** asyncio + TCP клиент
- **Упаковка:** PyInstaller (в EXE)

---

## **Ключевые компоненты**

### **A. Микро-модель "MudReflex-Core"**
**Роль:** Спинной мозг системы, рефлекторный процессор

**Характеристики:**
- Размер: 500 MB (GGUF Q4_K_M)
- Контекст: 1024 токенов (последние 3-5 сообщений MUD)
- Задержка: < 200 мс на CPU, < 50 мс на GPU
- Точность: 95%+ на базовых командах

**Область ответственности:**
1. **Автоматический парсинг** вывода MUD (локации, предметы, NPC)
2. **Классификация** типа ситуации (комната, бой, диалог, опасность)
3. **Генерация примитивных команд** (движение, сбор предметов, бой)
4. **Автореакции** при включенных настройках (авто-LOOK, авто-GET)

**Чего НЕ умеет (оставляем большой модели):**
- Планирование квестов
- Сложные диалоги с NPC
- Решение головоломок
- Долгосрочная стратегия

### **B. Графический интерфейс (одно окно, две панели)**
```
┌─────────────────────────────────────────────┐
│ [MUD Output]             [ИИ Советник]      │
│                                            │
│ Вывод игры...            [Режим: МИКРО-ИИ] │
│                          1. look           │
│                          2. north          │
│                          ○1 ○2 ○ Свой: [__]│
│                          [Отправить]       │
└─────────────────────────────────────────────┘
```

**Элементы:**
1. **Панель MUD** — текстовый вывод игры (read-only)
2. **Панель ИИ** — классификация + 2-3 варианта действий
3. **Выбор действий** — радио-кнопки для советов ИИ
4. **Поле ввода** — для своих команд
5. **Статус-бар** — подключение, модель, пинг

### **C. Система подключения к MUD**
- Поддержка TCP/Telnet соединений
- Автоопределение ANSI цветов (если есть)
- Сохранение нескольких серверов в конфигурации
- Автопереподключение при разрыве

### **D. Менеджер моделей (базовый)**
- Работает только с микро-моделью в MVP
- Загрузка при старте (2-3 секунды)
- Проверка доступности GPU, автонастройка слоев
- Место для будущей интеграции больших моделей

---

## **Поток работы пользователя**

### **Сценарий "Первые 5 минут":**
1. **Скачивание** → MudMind_Alpha.zip (150 MB сжатый)
2. **Распаковка** → в любую папку, без установки
3. **Запуск** → MudMind.exe
4. **Настройка подключения** → адрес MUD (localhost:4000)
5. **Подключение** → кнопка "Connect"
6. **Игра** → видит вывод MUD, ИИ предлагает варианты
7. **Выбор** → кликает на вариант ИИ или вводит свою команду
8. **Результат** → команда отправляется, цикл повторяется

### **Режимы взаимодействия:**
1. **Советник (основной)** — ИИ предлагает, пользователь выбирает
2. **Исполнитель** — ИИ выполняет задачу ("собери все предметы")
3. **Стенографист** — ИИ только запоминает, не предлагает

---

## **Обучение микро-модели (pre-MVP)**

### **Этап 1: Сбор датасета**
1. **Собрать** 1000+ примеров вывода из целевого MUD
2. **Разметить** вручную: что видно → что делать
3. **Формат:** JSONL с полями: input (текст MUD), classification, suggested_actions

### **Этап 2: Выбор базовой модели**
**Кандидаты:**
1. **TinyLlama 1.1B** (550MB) — лучший баланс
2. **Phi-2** (1.3B) — умнее, но больше
3. **Qwen2.5-0.5B** — специально маленькая

### **Этап 3: Дообучение**
- **Метод:** Инструктивное дообучение (LoRA)
- **Эпохи:** 3-5
- **Датасет:** 80% тренировка, 20% валидация
- **Цель:** 95% точность распознавания базовых команд

### **Этап 4: Квантование**
- **Формат:** GGUF Q4_K_M
- **Инструмент:** llama.cpp
- **Размер:** ~300-400MB
- **Тестирование:** на RTX 5060 Ti и слабом CPU

---

## **Roadmap после MVP**

### **Alpha 0.2 (База знаний)**
- Сохранение локаций в SQLite
- Простая текстовая карта
- Поиск по истории: "Где я видел ключ?"

### **Alpha 0.3 (Большая модель)**
- Поддержка внешних моделей (Llama 3 8B, Cydonia 24B)
- Автоматическое переключение по сложности
- Гибридный режим (микро + большая модель)

### **Alpha 0.4 (Улучшение GUI)**
- Раздельные окна (карта, инвентарь, диалоги)
- Графическая карта с квадратиками-локациями
- Темы оформления

---

## **Ограничения MVP**

### **Что будет в MVP:**
✅ Микро-модель с мгновенной реакцией  
✅ Базовый парсинг MUD вывода  
✅ 2-3 варианта действий от ИИ  
✅ Простой выбор через радио-кнопки  
✅ Автореакции (LOOK, GET при настройке)  
✅ Сохранение сессии в SQLite  

### **Что НЕ будет в MVP:**
❌ Графическая карта (только текстовый вывод)  
❌ Сложная база знаний  
❌ Большие модели (только микро)  
❌ Диалоги с NPC  
❌ Планирование квестов  
❌ Обучение в рантайме  

---

## **План разработки по неделям**


### **Неделя 1: Графический интерфейс**
- Основное окно с двумя панелями
- Связка GUI ↔ бэкенд (EventBus)
- Система выбора/отправки команд
- Настройки подключения к MUD

### **Неделя 2: Подготовка микро-модели**
- Сбор и разметка датасета MUD
- Выбор и дообучение базовой модели
- Квантование в GGUF, оптимизация

### **Неделя 3: Бэкенд ядро**
- TCP клиент для MUD (asyncio)
- Интеграция llama-cpp-python
- Система парсинга (минимальная)
- Менеджер сессий (SQLite)

### **Неделя 4: Интеграция и тестирование**
- Сборка всего в EXE (PyInstaller)
- Тестирование на целевых MUD
- Исправление багов, оптимизация
- Подготовка дистрибутива

---

## **Метрики успеха MVP**

### **Технические:**
- **Запуск:** ≤ 10 секунд от ярлыка до окна
- **Подключение:** ≤ 5 секунд к локальному MUD
- **Реакция ИИ:** ≤ 200 мс после получения текста MUD
- **Стабильность:** 30+ минут без падений
- **Память:** ≤ 1 GB RAM в использовании

### **Пользовательские:**
- **Простота:** Новый пользователь за 5 минут понимает как играть
- **Полезность:** 70% советов ИИ адекватны ситуации
- **Удовлетворение:** "Экономит время, не нужно постоянно печатать 'look'"

### **Бизнес-метрики:**
- **Распространение:** Дистрибутив ≤ 150 MB (сжатый)
- **Портируемость:** Работает с флешки без установки
- **Расширяемость:** Архитектура готова к большим моделям

---

## **Риски и mitigation**

### **Риск 1: Микро-модель слишком тупая**
**Mitigation:** 
- Использовать Phi-2 вместо TinyLlama если нужно
- Увеличить датасет до 5000 примеров
- Добавить больше контекста (2048 токенов)

### **Риск 2: Задержки на слабом железе**
**Mitigation:**
- Оптимизировать загрузку модели (часть на GPU)
- Кэшировать частые ответы
- Предоставить CPU-only режим

### **Риск 3: Несовместимость с разными MUD**
**Mitigation:**
- Универсальный парсер (ищет ключевые слова)
- Настройки regex под конкретный MUD
- Система плагинов в будущих версиях

---

## **Итоговый образ продукта MVP**

**MudMind Alpha 0.1 — это:**
> "Не гениальный ИИ, который пройдет игру за вас, а умный помощник, который экономит время на рутине. Как автодополнение команд для MUD. Минимум настроек, максимум полезности для повседневной игры."

**Целевой пользователь:** 
Геймер в текстовые MUD, который устал постоянно печатать одни и те же команды и хочет сосредоточиться на интересных частях игры.